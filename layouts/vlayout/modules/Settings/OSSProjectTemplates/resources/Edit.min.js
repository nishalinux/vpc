
function OSSProjectTemplatesEdit(){this.getNextStep=function(){var a=this;jQuery("#next_step_button").on("click",function(){var b=jQuery('input[name="next_step"]'),d={},c=jQuery(b).val();d.data={view:"Steps",parent:"Settings",module:"OSSProjectTemplates",step:c};AppConnector.request(d).then(function(e){jQuery("#step").html(e);if("Step2"==c){jQuery("#Step1").removeClass("active");jQuery("#Step2").addClass("active");jQuery(b).val("End")}else{if("End"==c){location.href="index.php?module=OSSProjectTemplates&parent=Settings&view=Index"}}})})},this.validProjectForm=function(a){var b=this;jQuery('form[name="'+a+'"] button:submit').on("click",function(f){var d=jQuery(this).parents("form").find("select,input,textarea"),c=true;jQuery(d).each(function(h,i){if(jQuery(i).hasClass("required")){var e=jQuery(i).val();if(""==e||"none"==e){c=false}}});if(!c){var g=app.vtranslate("JS_FILL_REQUIRED_FIELDS");b.showErrorMessage(g)}return c})},this.showErrorMessage=function(a){var b={title:app.vtranslate("JS_ERROR"),text:a,animation:true};Vtiger_Helper_Js.showPnotify(b)},this.edtProjectTpl=function(){var a=this;jQuery("a.edit_tpl").on("click",function(){var b=jQuery(this).parents("tr").data("id"),c={};c.data={module:"OSSProjectTemplates",parent:"Settings",action:"GetTplInfo",tpl_id:b,base_module:"Project"};c.async=false;AppConnector.request(c).then(function(i){if(i.success===true){jQuery('[name="tpl_id"]').val(b);for(var j in i.result){var h=a.isJsonArray(i.result[j]);if(!h){var g=jQuery('[name="'+j+'"]').prop("type");if("select-one"==g){jQuery('[name="'+j+'"]').val(i.result[j]);jQuery('[name="'+j+'"]').trigger("chosen:updated")}else{jQuery('[name="'+j+'"]').val(i.result[j])}}else{var f=JSON.parse(i.result[j]);jQuery("#"+j+"_edit").val(f).trigger("chosen:updated")}var d=jQuery('[name="'+j+'_day_type"]');var e=jQuery('[name="'+j+'_day"]');if(jQuery(e).length>0&&i.result[j]==="num_day"){jQuery(e).val(i.result[j+"_day"]);jQuery(e).removeAttr("readonly");if(jQuery(d).length>0&&i.result[j]==="num_day"){jQuery(d).removeAttr("disabled")}}if(jQuery(d).length>0&&i.result[j]==="num_day"){if(i.result[j+"_day_type"]==="on"){jQuery(d).attr("checked","checked");jQuery(d).removeAttr("disabled")}}}}});jQuery('form[name="edit_project_form"] select.select-date').on("change",function(){var f=jQuery(this).val();var d=this.name;var e=jQuery('input[name="'+d+'_day"]');var g=jQuery('input[name="'+d+'_day_type"]');if("num_day"===f){jQuery(e).removeAttr("readonly");jQuery(g).removeAttr("disabled")}else{jQuery(e).attr("readonly","readonly");jQuery(g).attr("disabled","disabled")}})})},this.selectDateEvent=function(){jQuery('form[name="project_form"] select.select-date').on("change",function(){var c=jQuery(this).val();var a=this.name;var b=jQuery('input[name="'+a+'_day"]')[0],d=jQuery('input[name="'+a+'_day_type"]')[0];if("num_day"===c){jQuery(b).removeAttr("readonly");jQuery(d).removeAttr("disabled")}else{jQuery(b).attr("readonly","readonly");jQuery(d).attr("disabled","disabled")}})},this.isNumber=function(a){var b=this;jQuery('form[name="'+a+'"] button:submit').on("click",function(f){var d=jQuery(this).parents("form").find("input.day-input"),c=true;jQuery(d).each(function(){var e=jQuery(this).attr("readonly");if(e!=="readonly"){var h=jQuery(this).val();c=!isNaN(parseFloat(h))&&isFinite(h)}});if(!c){var g=app.vtranslate("JS_FIELD_INCORRECT");b.showErrorMessage(g)}return c})},this.enableUninstallButton=function(){jQuery('input[name="status"]').on("change",function(){var a=jQuery(this).attr("checked");if(a==="checked"){jQuery("#confirm_unistall").removeAttr("disabled")}else{jQuery("#confirm_unistall").attr("disabled","disabled")}})},this.isJsonArray=function(b){try{var d=jQuery.parseJSON(b);var a=Object.prototype.toString.call(d);if(a==="[object Array]"){return true}return false}catch(c){return false}},this.registerButtonEvents=function(){$(".addButton").click(function(){app.showModalWindow($("#add_project_modal"))});$(".addTaskButton").click(function(){app.showModalWindow($("#step_2_modal"))});$(".addMilestoneButton").click(function(){app.showModalWindow($("#step_1_modal"))});$(".edit_tpl").click(function(){app.showModalWindow($("#edit_project_modal"))})},this.registerEvents=function(){this.getNextStep();this.validProjectForm("project_form");this.validProjectForm("edit_project_form");this.edtProjectTpl();this.isNumber("project_form");this.selectDateEvent();this.enableUninstallButton();this.registerButtonEvents()}}jQuery(document).ready(function(){var a=new OSSProjectTemplatesEdit();a.registerEvents()});